{"ast":null,"code":"import \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport Cropper from 'cropperjs';\nimport 'cropperjs/dist/cropper.css';\nexport default {\n  name: 'VueCropper',\n  props: {\n    imgFile: {\n      type: String,\n      default: 'https://bpic.588ku.com/element_water_img/18/06/12/b2887846cb19ff36a5502401ac918809.jpg'\n    },\n    ratioWidth: {\n      type: Number,\n      default: 0\n    },\n    ratioHeight: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      myCropper: null,\n      afterImg: '',\n      ScaleX: 1,\n      ScaleY: 1,\n      fixed: false,\n      fixedBox: false,\n      inputRotate: 0,\n      isDisabled: false\n    };\n  },\n  computed: {},\n  watch: {\n    imgFile: function (file) {\n      console.log(file);\n      this.imgFile = file;\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  methods: {\n    // 初始化\n    init() {\n      this.myCropper = new Cropper(this.$refs.image, {\n        // responsive: true, // 在窗口大小变化后，重新渲染裁剪器 默认 true\n        // restore: true, // 在窗口大小变化后，恢复被裁剪的区域 默认 true\n        // checkCrossOrigin: true, // 检查图片是否跨域\n        // modal: true, // 是否在图片和裁剪框之间显示黑色蒙版 默认 true\n        // guides: true, // 是否显示裁剪框的虚线 默认 true\n        // center: true, // 是否显示裁剪框中心的指示器 默认 true\n        // highlight: true, // 是否显示裁剪框上面的白色蒙版(突出显示裁剪框） 默认 true\n        background: false,\n        // 是否在容器内显示网格背景 默认 true\n        autoCrop: 1,\n        // 定义裁剪区域占图片的大小(百分比) 取值为 0-1 默认 0.8\n        // movable: true, // 是否可以移动图片 默认 true\n        // rotatable :true, // 是否可以旋转图片 默认 true\n        // scalable: true, // 是否可以缩放图片 默认 true\n        // zoomable: true, // 是否可以缩放图片（以图片左上角为原点进行缩放）默认 true\n        // zoomOnTouch: true, // 是否允许通过拖动来缩放图片 默认 true\n        zoomOnWheel: true,\n        // 是否允许通过鼠标滚轮缩放图片 默认 true\n        // wheelZoomRatio: true, // 设置通过鼠标滚轮缩放图片时的缩放比例 默认 0.1\n        cropBoxMovable: true,\n        // 是否允许通过拖动来移动裁剪框 默认 true\n        cropBoxResizable: true,\n        // 是否允许通过拖动来调整裁剪框的大小 默认 true\n        // toggleDragModeOnDblclick: true, // 是否允许双击切换图片容器拖拽模式(​​\"crop\"​​和​​\"move\"​​) 默认 true\n        // minContainerWidth: 400, // 设置裁剪容器的最小宽度 默认 200\n        // minContainerHeight: 400, // 设置裁剪容器的最小高度 默认 100\n        // minCanvasWidth: 0, // 设置图片容器的最小宽度 默认 0\n        minCropBoxWidth: 200,\n        // 设置裁剪框的最小宽度 默认 0 这个尺寸是相对于页面的，而不是图片\n        minCropBoxHeight: 200,\n        // 设置裁剪框的最小高度 默认 0 这个尺寸是相对于页面的，而不是图片\n        // preview: '.before', // 预览样式 如果需要预览 配置预览 class 即可\n        viewMode: 1,\n        // 裁剪器配置 [0:没有限制 1:限制裁剪框不超过图片容器的范围 2:限制最片容器尺寸以在裁剪容器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以cover模式填充（图片容器保持原有比例，最长边和裁剪容器大小一致，短边等比缩放，可能会有部分区域不可见) 3:限制图片容器尺寸以在裁剪器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以contain模式填充（图片容器保持原有比例，最短边和裁剪容器大小一直，长边等比缩放，可能会有留白）]\n        dragMode: 'move',\n        // 定义裁剪器的拖动模式 [crop:创建一个新的裁剪框 move:图片容器可移动 none:什么也不做] 默认 crop\n        // initialAspectRatio: 1, // 定义裁剪框的初始宽高比。默认和图片容器的宽高比相同 默认 NaN \n        autoCropArea: 0.2,\n        // 定义裁剪区域占图片的大小(百分比)。取值为 0 - 1\n        aspectRatio: this.ratioWidth / this.ratioHeight // 定义裁剪框的固定宽高比。默认是自由比例 NaN\n      });\n    },\n    // 取消\n    handleCancel() {\n      this.$emit('handleCancel');\n    },\n    // 缩放\n    handleZoom(val) {\n      this.myCropper.zoom(val);\n    },\n    // 旋转\n    handleRotate(val) {\n      this.myCropper.rotate(val);\n    },\n    // 绝对角度旋转\n    handleRotateTo(val) {\n      this.myCropper.rotateTo(val);\n    },\n    // 裁剪\n    uploadImgs() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleCropData', this.afterImg);\n    },\n    // 确定\n    handleConfirm() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleUpload', this.base64ToBlob(this.afterImg));\n    },\n    base64ToBlob(code) {\n      const parts = code.split(';base64,');\n      const contentType = parts[0].split(':')[1];\n      const raw = window.atob(parts[1]);\n      const rawLength = raw.length;\n      const uInt8Array = new Uint8Array(rawLength);\n      for (let i = 0; i < rawLength; ++i) {\n        uInt8Array[i] = raw.charCodeAt(i);\n      }\n      return new Blob([uInt8Array], {\n        type: contentType\n      });\n    },\n    // 重置    \n    handleReset() {\n      this.myCropper.reset();\n      this.ScaleX = 1;\n      this.ScaleY = 1;\n    },\n    // 移动\n    handleMove(val1, val2) {\n      this.myCropper.move(val1, val2);\n    },\n    // X轴翻转\n    handleCropperScaleX() {\n      this.ScaleX = -this.ScaleX;\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleY(this.ScaleX);\n      } else {\n        this.myCropper.scaleX(this.ScaleX);\n      }\n    },\n    // y轴翻转\n    handleCropperScaleY() {\n      this.ScaleY = -this.ScaleY;\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleX(this.ScaleY);\n      } else {\n        this.myCropper.scaleY(this.ScaleY);\n      }\n    }\n  }\n};","map":{"version":3,"names":["Cropper","name","props","imgFile","type","String","default","ratioWidth","Number","ratioHeight","data","myCropper","afterImg","ScaleX","ScaleY","fixed","fixedBox","inputRotate","isDisabled","computed","watch","file","console","log","mounted","init","methods","$refs","image","background","autoCrop","zoomOnWheel","cropBoxMovable","cropBoxResizable","minCropBoxWidth","minCropBoxHeight","viewMode","dragMode","autoCropArea","aspectRatio","handleCancel","$emit","handleZoom","val","zoom","handleRotate","rotate","handleRotateTo","rotateTo","uploadImgs","getCroppedCanvas","imageSmoothingQuality","toDataURL","handleConfirm","base64ToBlob","code","parts","split","contentType","raw","window","atob","rawLength","length","uInt8Array","Uint8Array","i","charCodeAt","Blob","handleReset","reset","handleMove","val1","val2","move","handleCropperScaleX","getImageData","scaleY","scaleX","handleCropperScaleY"],"sources":["src/page/Merchant/components/cropperjs.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"main-cropper\">\r\n      <!-- 剪裁框 -->\r\n      <div class=\"cropper\">\r\n        <img class=\"img\" ref=\"image\" :src=\"imgFile\" alt=\"\">\r\n      </div>\r\n      <!-- 底部 -->\r\n      <div class=\"cropper-footer\">\r\n        <div class=\"footer-handle\">\r\n          <div class=\"item\" @click=\"handleCancel\">取消</div>\r\n          <div class=\"item\" @click=\"handleZoom(0.05)\">放大</div>\r\n          <div class=\"item\" @click=\"handleZoom(-0.05)\">缩小</div>\r\n          <!-- <div class=\"item\" @click=\"handleRotate(-90)\">逆时针旋转</div> -->\r\n          <div class=\"item\" @click=\"handleRotate(90)\">旋转</div>\r\n          <div class=\"item\" @click=\"handleConfirm\">确定</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Cropper from 'cropperjs'\r\nimport 'cropperjs/dist/cropper.css'\r\nexport default {\r\n  name: 'VueCropper',\r\n  props: {\r\n    imgFile: {\r\n      type: String,\r\n      default: 'https://bpic.588ku.com/element_water_img/18/06/12/b2887846cb19ff36a5502401ac918809.jpg'\r\n    },\r\n    ratioWidth: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    ratioHeight: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      myCropper: null,\r\n      afterImg: '',\r\n      ScaleX: 1,\r\n      ScaleY: 1,\r\n      fixed: false,\r\n      fixedBox: false,\r\n      inputRotate: 0,\r\n      isDisabled: false\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {\r\n    imgFile: function(file) {\r\n      console.log(file);\r\n      this.imgFile = file\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  methods: {    \r\n    // 初始化\r\n    init() {\r\n      this.myCropper = new Cropper(this.$refs.image, {\r\n        // responsive: true, // 在窗口大小变化后，重新渲染裁剪器 默认 true\r\n        // restore: true, // 在窗口大小变化后，恢复被裁剪的区域 默认 true\r\n        // checkCrossOrigin: true, // 检查图片是否跨域\r\n        // modal: true, // 是否在图片和裁剪框之间显示黑色蒙版 默认 true\r\n        // guides: true, // 是否显示裁剪框的虚线 默认 true\r\n        // center: true, // 是否显示裁剪框中心的指示器 默认 true\r\n        // highlight: true, // 是否显示裁剪框上面的白色蒙版(突出显示裁剪框） 默认 true\r\n        background: false, // 是否在容器内显示网格背景 默认 true\r\n        autoCrop: 1, // 定义裁剪区域占图片的大小(百分比) 取值为 0-1 默认 0.8\r\n        // movable: true, // 是否可以移动图片 默认 true\r\n        // rotatable :true, // 是否可以旋转图片 默认 true\r\n        // scalable: true, // 是否可以缩放图片 默认 true\r\n        // zoomable: true, // 是否可以缩放图片（以图片左上角为原点进行缩放）默认 true\r\n        // zoomOnTouch: true, // 是否允许通过拖动来缩放图片 默认 true\r\n        zoomOnWheel: true, // 是否允许通过鼠标滚轮缩放图片 默认 true\r\n        // wheelZoomRatio: true, // 设置通过鼠标滚轮缩放图片时的缩放比例 默认 0.1\r\n        cropBoxMovable: true, // 是否允许通过拖动来移动裁剪框 默认 true\r\n        cropBoxResizable: true, // 是否允许通过拖动来调整裁剪框的大小 默认 true\r\n        // toggleDragModeOnDblclick: true, // 是否允许双击切换图片容器拖拽模式(​​\"crop\"​​和​​\"move\"​​) 默认 true\r\n        // minContainerWidth: 400, // 设置裁剪容器的最小宽度 默认 200\r\n        // minContainerHeight: 400, // 设置裁剪容器的最小高度 默认 100\r\n        // minCanvasWidth: 0, // 设置图片容器的最小宽度 默认 0\r\n        minCropBoxWidth: 200, // 设置裁剪框的最小宽度 默认 0 这个尺寸是相对于页面的，而不是图片\r\n        minCropBoxHeight: 200, // 设置裁剪框的最小高度 默认 0 这个尺寸是相对于页面的，而不是图片\r\n        // preview: '.before', // 预览样式 如果需要预览 配置预览 class 即可\r\n        viewMode: 1, // 裁剪器配置 [0:没有限制 1:限制裁剪框不超过图片容器的范围 2:限制最片容器尺寸以在裁剪容器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以cover模式填充（图片容器保持原有比例，最长边和裁剪容器大小一致，短边等比缩放，可能会有部分区域不可见) 3:限制图片容器尺寸以在裁剪器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以contain模式填充（图片容器保持原有比例，最短边和裁剪容器大小一直，长边等比缩放，可能会有留白）]\r\n        dragMode: 'move', // 定义裁剪器的拖动模式 [crop:创建一个新的裁剪框 move:图片容器可移动 none:什么也不做] 默认 crop\r\n        // initialAspectRatio: 1, // 定义裁剪框的初始宽高比。默认和图片容器的宽高比相同 默认 NaN \r\n        autoCropArea: 0.2, // 定义裁剪区域占图片的大小(百分比)。取值为 0 - 1\r\n        aspectRatio: this.ratioWidth / this.ratioHeight // 定义裁剪框的固定宽高比。默认是自由比例 NaN\r\n      })\r\n    },\r\n    // 取消\r\n    handleCancel() {\r\n      this.$emit('handleCancel')\r\n    },\r\n    // 缩放\r\n    handleZoom(val) {\r\n      this.myCropper.zoom(val)\r\n    },\r\n    // 旋转\r\n    handleRotate(val) {\r\n      this.myCropper.rotate(val)\r\n    },\r\n    // 绝对角度旋转\r\n    handleRotateTo(val) {\r\n      this.myCropper.rotateTo(val)\r\n    },\r\n    // 裁剪\r\n    uploadImgs() {\r\n      this.afterImg = this.myCropper.getCroppedCanvas({\r\n        imageSmoothingQuality: 'high'\r\n      }).toDataURL('image/jpeg');\r\n      this.$emit('handleCropData', this.afterImg)\r\n    },\r\n    // 确定\r\n    handleConfirm() {\r\n      this.afterImg = this.myCropper.getCroppedCanvas({\r\n        imageSmoothingQuality: 'high'\r\n      }).toDataURL('image/jpeg');\r\n      this.$emit('handleUpload', this.base64ToBlob(this.afterImg))\r\n    },\r\n    base64ToBlob(code) {\r\n      const parts = code.split(';base64,');\r\n      const contentType = parts[0].split(':')[1];\r\n      const raw = window.atob(parts[1]);\r\n      const rawLength = raw.length;\r\n      const uInt8Array = new Uint8Array(rawLength);\r\n      for (let i = 0; i < rawLength; ++i) {\r\n        uInt8Array[i] = raw.charCodeAt(i);\r\n      }\r\n      return new Blob([uInt8Array], {\r\n        type: contentType\r\n      })\r\n    },    \r\n    // 重置    \r\n    handleReset() {\r\n      this.myCropper.reset();\r\n      this.ScaleX = 1;\r\n      this.ScaleY = 1;\r\n    },\r\n    // 移动\r\n    handleMove(val1, val2) {\r\n      this.myCropper.move(val1, val2);\r\n    },\r\n    // X轴翻转\r\n    handleCropperScaleX() {\r\n      this.ScaleX = -this.ScaleX\r\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\r\n        this.myCropper.scaleY(this.ScaleX)\r\n      } else {\r\n        this.myCropper.scaleX(this.ScaleX)\r\n      }\r\n    },\r\n    // y轴翻转\r\n    handleCropperScaleY() {\r\n      this.ScaleY = -this.ScaleY\r\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\r\n        this.myCropper.scaleX(this.ScaleY)\r\n      } else {\r\n        this.myCropper.scaleY(this.ScaleY)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n*{margin: 0; padding: 0;}\r\n.main-cropper{position: fixed; top: 0; right: 0; bottom: 0; left: 0;z-index:10000;}\r\n.main-cropper .cropper{position: absolute; top: 0; right: 0; bottom: 54px; left: 0; overflow: hidden; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC);}\r\n.main-cropper .cropper .img{width: 90%; opacity: 0;}\r\n/**/\r\n.main-cropper .cropper-footer{width: 100%; position: fixed; left: 0; bottom: 0;}\r\n.main-cropper .cropper-footer .footer-handle{padding: 10px 10px; display: flex; flex-direction:row; justify-content:space-between;}\r\n.main-cropper .cropper-footer .item{width: 60px; height: 34px; line-height: 34px; text-align: center; background: #28a745; color: #fff; cursor: pointer; border-radius: 4px; font-size: 15px;}\r\n.main-cropper .cropper-footer .item:first-child{background: #909399;}\r\n.main-cropper .cropper-footer .item:last-child{background: #409EFF;}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}