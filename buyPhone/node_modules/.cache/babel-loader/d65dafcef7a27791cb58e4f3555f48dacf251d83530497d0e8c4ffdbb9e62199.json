{"ast":null,"code":"import \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"core-js/modules/es.array.push.js\";\nimport Vcode from \"vue-puzzle-vcode\";\nimport NationalityList from '@/components/NationalityList';\nimport { getIdcode } from '@/API/common';\nimport { savePhone } from '@/API/user';\nexport default {\n  name: 'BindPhone',\n  components: {\n    NationalityList,\n    Vcode\n  },\n  data() {\n    return {\n      img1: require('@/assets/image/slider/1.png'),\n      img2: require('@/assets/image/slider/2.png'),\n      img3: require('@/assets/image/slider/3.png'),\n      img4: require('@/assets/image/slider/4.png'),\n      img5: require('@/assets/image/slider/5.png'),\n      triangleDown: require('@/assets/image/me/triangle_down.png'),\n      show: false,\n      pageDiaCode: false,\n      dialCode: localStorage.getItem('dialCode') || 1,\n      codeBtnTxt: this.$t('收取验证码'),\n      count: 60,\n      interval: null,\n      btnDisabled: false,\n      formData: {\n        phone: '',\n        verifcode: ''\n      }\n    };\n  },\n  methods: {\n    onClickLeft() {\n      this.$router.push({\n        path: '/Setting',\n        dir: 'left'\n      });\n    },\n    onSuccess() {\n      this.submitHandle();\n      this.show = false;\n    },\n    getName(params) {\n      if (!this.pageDiaCode) {\n        this.pageDiaCode = true;\n      } else {\n        this.dialCode = params[2];\n        localStorage.setItem('dialCode', this.dialCode);\n      }\n    },\n    openNational() {\n      this.$refs.controlChild.open();\n    },\n    getCode() {\n      if (this.formData.phone === '') {\n        _Toast(this.$t('请输入手机号'));\n        return;\n      } else {\n        const reg = /^[0-9]+[0-9]*$/;\n        if (!reg.test(this.formData.phone)) {\n          _Toast(this.$t('手机号格式有误'));\n          return;\n        }\n      }\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('发送中'),\n        forbidClick: true\n      });\n      const params = {\n        target: `${this.dialCode} ${this.formData.phone}`\n      };\n      getIdcode(params).then(() => {\n        _Toast.success(this.$t('发送成功'));\n        this.timerFn();\n      }).catch(err => {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    },\n    timerFn() {\n      this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`;\n      this.btnDisabled = true;\n      this.interval = setInterval(() => {\n        if (this.count === 1) {\n          this.count = 60;\n          this.codeBtnTxt = this.$t('再次获取');\n          this.btnDisabled = false;\n          clearInterval(this.interval);\n        } else {\n          this.count -= 1;\n          this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`;\n        }\n      }, 1000);\n    },\n    submitVertify() {\n      if (this.formData.phone === '') {\n        _Toast(this.$t('请输入手机号'));\n        return;\n      } else {\n        const reg = /^[0-9]+[0-9]*$/;\n        if (!reg.test(this.formData.phone)) {\n          _Toast(this.$t('手机号格式有误'));\n          return;\n        }\n      }\n      if (this.formData.verifcode === '') {\n        _Toast(this.$t('请输入验证码'));\n        return;\n      }\n      this.show = true;\n    },\n    submitHandle() {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('提交中'),\n        forbidClick: true\n      });\n      const params = {\n        ...this.formData,\n        phone: `${this.dialCode} ${this.formData.phone}`\n      };\n      savePhone(params).then(async () => {\n        _Toast.success(this.$t('绑定成功'));\n        await this.$store.dispatch('getUserInfo');\n        this.onClickLeft();\n      }).catch(err => {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    }\n  }\n};","map":{"version":3,"names":["Vcode","NationalityList","getIdcode","savePhone","name","components","data","img1","require","img2","img3","img4","img5","triangleDown","show","pageDiaCode","dialCode","localStorage","getItem","codeBtnTxt","$t","count","interval","btnDisabled","formData","phone","verifcode","methods","onClickLeft","$router","push","path","dir","onSuccess","submitHandle","getName","params","setItem","openNational","$refs","controlChild","open","getCode","_Toast","reg","test","loading","duration","message","forbidClick","target","then","success","timerFn","catch","err","clear","setInterval","clearInterval","submitVertify","$store","dispatch"],"sources":["src/page/BindPhone/index.vue"],"sourcesContent":["<template>\r\n    <div class=\"page-content\" style=\"min-height: 100vh;\">\r\n        <nationality-list ref='controlChild' :title=\"$t('选择区域码')\" @getName=\"getName(arguments)\"></nationality-list>\r\n        <Vcode style=\"direction: ltr;\" :imgs=\"[img1, img2, img3, img4, img5]\" :show=\"show\" @success=\"onSuccess\" :canvasHeight=\"200\"\r\n            @close=\"show = false;\" :sliderText=\"$t('拖动滑块以完成拼图')\" :successText=\"$t('验证通过!')\" :failText=\"$t('验证失败,请重试')\" />\r\n\r\n        <van-nav-bar safe-area-inset-top fixed :title=\" $t('手机绑定') \" left-arrow @click-left=\" onClickLeft \" />\r\n        <div style=\"width: 100%;\" class=\"h46\"></div>\r\n\r\n        <div class=\"form-content\">\r\n            <div class=\"form-item\">\r\n                <div class=\"title\">{{ $t('手机号') }}</div>\r\n                <div class=\"input-content\">\r\n                    <el-input :placeholder=\" $t('请输入手机号') \" maxlength=\"20\" v-model=\" formData.phone \" clearable>\r\n                        <div slot=\"prepend\" @click=\" openNational \">\r\n                            <p>+<span>{{ dialCode }}</span> <img :src=\" triangleDown \" alt=\"\" class=\"icon\" /></p>\r\n                        </div>\r\n                    </el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"form-item\">\r\n                <div class=\"title\">{{ $t('验证码') }}</div>\r\n                <div class=\"input-content code\">\r\n                    <el-input :placeholder=\" $t('请输入验证码') \" maxlength=\"6\" v-model=\" formData.verifcode \">\r\n                    </el-input>\r\n                    <div class=\"btn\" :class=\" { 'disabled': btnDisabled } \" @click=\" getCode \">{{ codeBtnTxt }}</div>\r\n                </div>\r\n            </div>\r\n            <div class=\"submit-btn\" @click=\" submitVertify \">{{ $t('提交') }}</div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { Toast } from \"vant\";\r\nimport Vcode from \"vue-puzzle-vcode\";\r\nimport NationalityList from '@/components/NationalityList'\r\nimport {\r\n    getIdcode\r\n} from '@/API/common'\r\nimport {\r\n    savePhone\r\n} from '@/API/user'\r\nexport default {\r\n    name: 'BindPhone',\r\n    components: {\r\n        NationalityList,\r\n        Vcode\r\n    },\r\n    data() {\r\n        return {\r\n            img1: require('@/assets/image/slider/1.png'),\r\n            img2: require('@/assets/image/slider/2.png'),\r\n            img3: require('@/assets/image/slider/3.png'),\r\n            img4: require('@/assets/image/slider/4.png'),\r\n            img5: require('@/assets/image/slider/5.png'),\r\n            triangleDown: require('@/assets/image/me/triangle_down.png'),\r\n            show: false,\r\n            pageDiaCode: false,\r\n            dialCode: localStorage.getItem('dialCode') || 1,\r\n            codeBtnTxt: this.$t('收取验证码'),\r\n            count: 60,\r\n            interval: null,\r\n            btnDisabled: false,\r\n            formData: {\r\n                phone: '',\r\n                verifcode: ''\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        onClickLeft() {\r\n            this.$router.push({ path: '/Setting', dir: 'left' })\r\n\r\n        },\r\n\r\n        onSuccess() {\r\n            this.submitHandle()\r\n            this.show = false\r\n        },\r\n\r\n        getName(params) {\r\n            if (!this.pageDiaCode) {\r\n                this.pageDiaCode = true\r\n            } else {\r\n                this.dialCode = params[2]\r\n                localStorage.setItem('dialCode', this.dialCode)\r\n            }\r\n        },\r\n\r\n        openNational() {\r\n            this.$refs.controlChild.open()\r\n        },\r\n\r\n        getCode() {\r\n            if (this.formData.phone === '') {\r\n                Toast(this.$t('请输入手机号'));\r\n                return\r\n            } else {\r\n                const reg = /^[0-9]+[0-9]*$/\r\n                if (!reg.test(this.formData.phone)) {\r\n                    Toast(this.$t('手机号格式有误'));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            Toast.loading({\r\n                duration: 0,\r\n                message: this.$t('发送中'),\r\n                forbidClick: true,\r\n            })\r\n\r\n            const params = {\r\n                target: `${this.dialCode} ${this.formData.phone}`\r\n            }\r\n\r\n            getIdcode(params).then(() => {\r\n                Toast.success(this.$t('发送成功'))\r\n                this.timerFn()\r\n            }).catch(err => {\r\n                Toast.clear()\r\n                // Toast.fail(err.msg)\r\n            })\r\n        },\r\n\r\n        timerFn() {\r\n            this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`\r\n            this.btnDisabled = true\r\n            this.interval = setInterval(() => {\r\n                if (this.count === 1) {\r\n                    this.count = 60\r\n                    this.codeBtnTxt = this.$t('再次获取')\r\n                    this.btnDisabled = false\r\n                    clearInterval(this.interval)\r\n                } else {\r\n                    this.count -= 1\r\n                    this.codeBtnTxt = `${this.$t('再次获取')} ${this.count} s`\r\n                }\r\n            }, 1000)\r\n        },\r\n\r\n        submitVertify() {\r\n            if (this.formData.phone === '') {\r\n                Toast(this.$t('请输入手机号'));\r\n                return\r\n            } else {\r\n                const reg = /^[0-9]+[0-9]*$/\r\n                if (!reg.test(this.formData.phone)) {\r\n                    Toast(this.$t('手机号格式有误'));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (this.formData.verifcode === '') {\r\n                Toast(this.$t('请输入验证码'));\r\n                return\r\n            }\r\n\r\n            this.show = true\r\n        },\r\n\r\n        submitHandle() {\r\n            Toast.loading({\r\n                duration: 0,\r\n                message: this.$t('提交中'),\r\n                forbidClick: true,\r\n            })\r\n\r\n            const params = {\r\n                ...this.formData,\r\n                phone: `${this.dialCode} ${this.formData.phone}`\r\n            }\r\n            savePhone(params).then(async () => {\r\n                Toast.success(this.$t('绑定成功'))\r\n                await this.$store.dispatch('getUserInfo')\r\n                this.onClickLeft()\r\n            }).catch(err => {\r\n                Toast.clear()\r\n                // Toast.fail(err.msg)\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page-content {\r\n    * {\r\n        box-sizing: border-box;\r\n    }\r\n\r\n    /deep/ .el-input {\r\n        input:focus {\r\n            border-color: var(--main-color) !important;\r\n        }\r\n    }\r\n\r\n    .form-content {\r\n        padding: 0 15px;\r\n\r\n        .form-item {\r\n            >.title {\r\n                font-size: 14px;\r\n                line-height: 16px;\r\n                color: #333333;\r\n                margin-top: 25px;\r\n                margin-bottom: 10px;\r\n            }\r\n\r\n            >.input-content {\r\n                /deep/ .el-input-group--prepend {\r\n                    .el-input-group__prepend {\r\n                        background-color: transparent !important;\r\n                        color: #000 !important;\r\n                        border-right: none !important;\r\n                        padding: 0 15px !important;\r\n\r\n                        .icon {\r\n                            width: 10px;\r\n                            height: auto;\r\n                            position: relative;\r\n                            top: -1px;\r\n                            margin-left: 5px;\r\n                        }\r\n                    }\r\n\r\n                    .el-input__inner {\r\n                        border-left-color: #fff;\r\n                    }\r\n                }\r\n\r\n                &.code {\r\n                    position: relative;\r\n\r\n                    >.btn {\r\n                        padding: 0 20px;\r\n                        height: 40px;\r\n                        position: absolute;\r\n                        right: 0;\r\n                        bottom: 0;\r\n                        font-size: 14px;\r\n                        \r\n                        color: var(--main-color);\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n\r\n                        &.disabled {\r\n                            pointer-events: none;\r\n                            opacity: 0.9;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .submit-btn {\r\n            margin-top: 40px;\r\n            width: 345px;\r\n            height: 44px;\r\n            // background: var(--main-color);\r\n            background: var(--main-color);\r\n            border-radius: 4px;\r\n            font-style: normal;\r\n            font-weight: 400;\r\n            font-size: 16px;\r\n            line-height: 44px;\r\n            text-align: center;\r\n            color: #FFFFFF;\r\n        }\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}